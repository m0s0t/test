
/* ---------- Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© (dummy) ---------- */
const DB = {
  // ğŸš© Ø§Ù„Ø£Ù‚Ø³Ø§Ù… (departments)
  departments: [
    {
      id: "anesthesia",
      name: "Ø§Ù„ØªØ®Ø¯ÙŠØ±",
      about: "Ù‚Ø³Ù… Ù…ØªØ®ØµØµ Ø¨Ø§Ù„Ø¹Ù†Ø§ÙŠØ© ÙˆØ§Ù„ØªØ®Ø¯ÙŠØ±.",
      stages: ["Stage 2", "Stage 3.1"],
      teachers: ["Ø¯. Ù„ÙŠØ«", "Ø¯.Ø¹Ø§Ø¯Ù„"]
    },
    
  ],

  // ğŸš© Ø§Ù„Ø¯ÙˆØ±Ø§Øª (courses)
  courses: [
    // === Ø§Ù„Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ø£ØµÙ„ÙŠØ© ===
   {
  id: "an2",
  title: "Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ø§Ù„ØªØ®Ø¯ÙŠØ±",
  desc: "Ù…Ø­Ø§Ø¶Ø±Ø§Øª ÙÙŠ Ù…Ø§Ø¯Ø© Ø§Ù„ØªØ®Ø¯ÙŠØ± Ø§Ù„ÙˆØ²Ø§Ø±ÙŠØ© Ù„Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©",
  subject: " ØªØ®Ø¯ÙŠØ± ÙˆØ²Ø§Ø±ÙŠ",
  stage: "Stage 3.2",
  dept: "anesthesia",
  thumb: "an.png",
  doctor: "Ø¯. Ø­Ø³Ø§Ù…",
  lessons: [
    {
      id: "an2L1",
      title: "Regional Anaesthesia",
      yt: "HXCs6U7iF4s"
    },
    {
      id: "an2L2",
      title: "Renal Disease and Anesthesia",
      yt: "buWSlHhCdPU"
    },
    {
      id: "an2L3",
      title: "Liver Disease and Anesthesia",
      yt: "IezLnNJVg5s"
    },
    {
      id: "an2L4",
      title: "Anesthesia for orthopedic surgery",
      yt: "QilDCovuP6A"
    },
    {
      id: "an2L5",
      title: "Day case surgery",
      yt: "htPOCiRo80A"
    },
    {
      id: "an2L6",
      title: "Anesthesia for laparoscopic surgery",
      yt: "LQUswDYEfvI"
    },
    {
      id: "an2L7",
      title: "Non Operating Room Anaesthesia (NORA)",
      yt: "hQoMO4dSTHw"
    },
    {
      id: "an2L8",
      title: "Anesthesia for ophthalmic surgery",
      yt: "D-gBvoaukLc"
    }
    ]
  },

    {
  id: "ana3.2",
  title: "Ø§Ù„Ø¹Ù†Ø§ÙŠØ© ÙˆØ²Ø§Ø±ÙŠ Ù…Ø±Ø­Ù„Ø© Ø«Ø§Ù„Ø«Ø©",
  desc: "Ù‚Ø§Ø¦Ù…Ø© ØªØ´ØºÙŠÙ„ Ù„ÙØ¯ÙŠÙˆÙ‡Ø§Øª Ø¯ÙƒØªÙˆØ± Ø­Ø³Ø§Ù… ÙÙŠ Ù…Ø§Ø¯Ø© Ø§Ù„Ø¹Ù†Ø§ÙŠØ© Ù„Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©",
  subject: "Ø¹Ù†Ø§ÙŠØ© ÙˆØ²Ø§Ø±ÙŠ",
  stage: "Stage 3.2",
  dept: "anesthesia",
  thumb: "an2.PNG",
  doctor: "Ø¯. Ø­Ø³Ø§Ù…",
  lessons: [
    {
      id: "ana3L1",
      title: "Respiratory monitoring",
      yt: "HQSBcsyGp6s"
    },
    {
      id: "ana3L2",
      title: "ARDS and ALI",
      yt: "fHKk0elS438"
    },
    {
      id: "ana3L3",
      title: "COPD and Acute asthma",
      yt: "4G025boFktM"
    },
    {
      id: "ana3L4",
      title: "Arterial Blood Gas Analysis ABG",
      yt: "S49wI1Nd2Tc"
    },
    {
      id: "ana3L5",
      title: "Cardiopulmonary resuscitation CPR",
      yt: "adXy666nh1Q"
    },
    {
      id: "ana3L6",
      title: "Mechanical Ventilation in Brain Injured Patients",
      yt: "YCK77rQJDr4"
    },
    {
      id: "ana3L7",
      title: "Fluid therapy for critical ill patient",
      yt: "tbi59UK4yPU"
    },
    {
      id: "ana3L8",
      title: "Blood transfusion",
      yt: "OSXIWigGAEg"
    },
    {
      id: "ana3L9",
      title: "Status epilepticus",
      yt: "Mg1YYp0GJMI"
    }
  ]
},


  ],

  // ğŸš© Ø§Ù„Ù…Ù„Ø§Ø²Ù… (notes)
  notes: [
    // ğŸ”¹ Ù…Ø§Ø¯Ø© Ø§Ø¬Ù‡Ø²Ø© Ù†Ø¸Ø±ÙŠ - Ù…Ø±Ø­Ù„Ø© Ø«Ø§Ù„Ø«Ø© ØªØ®Ø¯ÙŠØ±
{
  id: "e101",
  subject: "Ø§Ø¬Ù‡Ø²Ø© Ù†Ø¸Ø±ÙŠ",
  number: 1,
  title: "Tracheal Tube",
  teacher: "Ø¯. Ø¹Ø§Ø¯Ù„",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/ah3k1l1.pdf"
},
{
  id: "e102",
  subject: "Ø§Ø¬Ù‡Ø²Ø© Ù†Ø¸Ø±ÙŠ",
  number: 2,
  title: "Oropharyngeal Airways",
  teacher: "Ø¯. Ø¹Ø§Ø¯Ù„",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/ah3k1l2.pdf"
},
{
  id: "e103",
  subject: "Ø§Ø¬Ù‡Ø²Ø© Ù†Ø¸Ø±ÙŠ",
  number: 3,
  title: "Laryngeal Mask",
  teacher: "Ø¯. Ø¹Ø§Ø¯Ù„",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/ah3k1l3.pdf"
},
{
  id: "e104",
  subject: "Ø§Ø¬Ù‡Ø²Ø© Ù†Ø¸Ø±ÙŠ",
  number: 4,
  title: "Laryngoscope",
  teacher: "Ø¯. Ø¹Ø§Ø¯Ù„",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/ah3k1l4.pdf"
},
{
  id: "e105",
  subject: "Ø§Ø¬Ù‡Ø²Ø© Ù†Ø¸Ø±ÙŠ",
  number: 5,
  title: "Humidifiers",
  teacher: "Ø¯. Ø¹Ø§Ø¯Ù„",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/ah3k1l5.pdf"
},
{
  id: "e106",
  subject: "Ø§Ø¬Ù‡Ø²Ø© Ù†Ø¸Ø±ÙŠ",
  number: 6,
  title: "Nebulizers",
  teacher: "Ø¯. Ø¹Ø§Ø¯Ù„",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/ah3k1l6.pdf"
},
{
  id: "e107",
  subject: "Ø§Ø¬Ù‡Ø²Ø© Ù†Ø¸Ø±ÙŠ",
  number: 7,
  title: "Medical Suction Apparatus",
  teacher: "Ø¯. Ø¹Ø§Ø¯Ù„",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/ah3k1l7.pdf"
},
    {
      id: "n101",
      subject: "Ø§Ø¬Ù‡Ø²Ø© Ù…Ø±ØªØ¨",
      number: 1,
      title: "Ø§Ø¬Ù‡Ø²Ø© Ù†Ø¸Ø±ÙŠ 1",
      teacher: "Ø¯. Ù…ÙŠØ«Ù…",
      dept: "anesthesia",
      stage: "Stage 3.1",
      file: "files/a1.pdf"
    },
    // ğŸ”¹ Ù…Ø§Ø¯Ø© Ø¨Ø§Ø·Ù†ÙŠ Ù†Ø¸Ø±ÙŠ - Ù…Ø±Ø­Ù„Ø© Ø«Ø§Ù„Ø«Ø© ØªØ®Ø¯ÙŠØ±
{
  id: "m101",
  subject: "Ø¨Ø§Ø·Ù†ÙŠ Ù†Ø¸Ø±ÙŠ",
  number: 1,
  title: "Jaundice",
  teacher: "Ø¯. Ø§Ø­Ù…Ø¯ Ø­Ø³Ù† Ø±Ø§Ø¶ÙŠ",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/ba3k1l1.pdf"
},
{
  id: "m102",
  subject: "Ø¨Ø§Ø·Ù†ÙŠ Ù†Ø¸Ø±ÙŠ",
  number: 2,
  title: "Peptic Ulcer",
  teacher: "Ø¯. Ø§Ø­Ù…Ø¯ Ø­Ø³Ù† Ø±Ø§Ø¶ÙŠ",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/ba3k1l2.pdf"
},
{
  id: "m103",
  subject: "Ø¨Ø§Ø·Ù†ÙŠ Ù†Ø¸Ø±ÙŠ",
  number: 3,
  title: "Cerebrovascular Accident",
  teacher: "Ø¯. Ø§Ø­Ù…Ø¯ Ø­Ø³Ù† Ø±Ø§Ø¶ÙŠ",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/ba3k1l3.pdf"
},
{
  id: "m104",
  subject: "Ø¨Ø§Ø·Ù†ÙŠ Ù†Ø¸Ø±ÙŠ",
  number: 4,
  title: "Renal Failure",
  teacher: "Ø¯. Ø§Ø­Ù…Ø¯ Ø­Ø³Ù† Ø±Ø§Ø¶ÙŠ",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/ba3k1l4.pdf"
},
{
  id: "m105",
  subject: "Ø¨Ø§Ø·Ù†ÙŠ Ù†Ø¸Ø±ÙŠ",
  number: 5,
  title: "Coronary Artery Diseases",
  teacher: "Ø¯. Ø§Ø­Ù…Ø¯ Ø­Ø³Ù† Ø±Ø§Ø¶ÙŠ",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/ba3k1l5.pdf"
},
{
  id: "m106",
  subject: "Ø¨Ø§Ø·Ù†ÙŠ Ù†Ø¸Ø±ÙŠ",
  number: 6,
  title: "Arrhythmia",
  teacher: "Ø¯. Ø§Ø­Ù…Ø¯ Ø­Ø³Ù† Ø±Ø§Ø¶ÙŠ",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/ba3k1l6.pdf"
},
{
  id: "m107",
  subject: "Ø¨Ø§Ø·Ù†ÙŠ Ù†Ø¸Ø±ÙŠ",
  number: 7,
  title: "Hypertension",
  teacher: "Ø¯. Ø§Ø­Ù…Ø¯ Ø­Ø³Ù† Ø±Ø§Ø¶ÙŠ",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/ba3k1l7.pdf"
},
    {
      id: "n102",
      subject: "Ø§Ø¬Ù‡Ø²Ø© Ù†Ø¸Ø±ÙŠ",
      number: 2,
      title:"Ø§Ø¬Ù‡Ø²Ø© Ù…Ø±ØªØ¨",
      teacher: "Ø¯. Ù…ÙŠØ«Ù…",
      dept: "anesthesia",
      stage: "Stage 3.1",
      file: "files/a2.pdf"
    },
    {
      id: "n103",
      subject: "Ø§Ø¬Ù‡Ø²Ø© Ù†Ø¸Ø±ÙŠ",
      subject: " Ø§Ø¬Ù‡Ø²Ø© Ù…Ø±ØªØ¨",
      number: 3,
      title: "Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ù†Ø¸Ø±ÙŠ 3",
      teacher: "Ø¯. Ù…ÙŠØ«Ù…",
      dept: "anesthesia",
      stage: "Stage 3.1",
      file: "files/a3.pdf"
    },
    {
      id: "n104",
      subject: "Ø¹Ù†Ø§ÙŠØ© Ø¹Ù…Ù„ÙŠ",
      number: "1,2,3",
      title: "Ø¹Ù†Ø§ÙŠØ© Ø¹Ù…Ù„ÙŠ",
      teacher: "Ø¯. Ø¹Ø§Ø¯Ù„",
      dept: "anesthesia",
      stage: "Stage 3.1",
      file: "files/m123.pdf"
    },
  
   {
  id: "n101",
  subject: "ØªØ®Ø¯ÙŠØ± Ù†Ø¸Ø±ÙŠ",
  number: 1,
  title: "Introduction to Anesthesiology",
  teacher: "Dr. Waad A. Hayder ",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/AN.K1.L1.PDF"
},
{
  id: "n102",
  subject: "ØªØ®Ø¯ÙŠØ± Ù†Ø¸Ø±ÙŠ",
  number: 2,
  title: "Drugs used in premedication ",
  teacher: "Dr. Waad A. Hayder ",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/AN.K1.L2.PDF"
},
{
  id: "n103",
  subject: "ØªØ®Ø¯ÙŠØ± Ù†Ø¸Ø±ÙŠ",
  number: 3,
  title: "Inhalational anesthetic agents",
  teacher: "Dr. Waad A. Hayder ",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/AN.K1.L3.PDF"
},
{
  id: "n104",
  subject: "ØªØ®Ø¯ÙŠØ± Ù†Ø¸Ø±ÙŠ",
  number: 4,
  title: "Intravenous anesthetic agents ",
  teacher: "Dr. Waad A. Hayder ",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/AN.K1.L4.PDF"
},
{
  id: "n105",
  subject: "ØªØ®Ø¯ÙŠØ± Ù†Ø¸Ø±ÙŠ",
  number: 5,
  title: " NEUROMUSCULAR BLOCKADE",
  teacher: "Dr. Waad A. Hayder ",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/AN.K1.L5.PDF"
},
{
  id: "n106",
  subject: "ØªØ®Ø¯ÙŠØ± Ù†Ø¸Ø±ÙŠ",
  number: 6,
  title: "General Principles of Pharmacology",
  teacher: "Dr. Waad A. Hayder ",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/AN.K1.L6.PDF"
},
{
  id: "n107",
  subject: "ØªØ®Ø¯ÙŠØ± Ù†Ø¸Ø±ÙŠ",
  number: 7,
  title: "Choice of anesthetic method and anesthetic agents",
  teacher: "Dr. Waad A. Hayder ",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/AN.K1.L7.PDF"
},
{
  id: "n108",
  subject: "ØªØ®Ø¯ÙŠØ± Ù†Ø¸Ø±ÙŠ",
  number: 8,
  title: "Preanaesthetic visit and assessment ",
  teacher: "Dr. Waad A. Hayder ",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/AN.K1.L8.PDF"
},
// ğŸ”¹ Ù…Ø§Ø¯Ø© Ø§Ù„Ø¬Ø±Ø§Ø­Ø© Ø§Ù„Ù†Ø¸Ø±ÙŠ - Ù…Ø±Ø­Ù„Ø© Ø«Ø§Ù„Ø«Ø© ØªØ®Ø¯ÙŠØ±
{
  id: "s101",
  subject: "Ø¬Ø±Ø§Ø­Ø© Ù†Ø¸Ø±ÙŠ",
  number: 1,
  title: "Git (Upper and Lower)",
  teacher: "Ø¯. Ø¥Ø³Ø±Ø§Ø¡ + Ø¯. Ø±ÙŠÙ…",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/SU3K1L1.pdf"
},
{
  id: "s102",
  subject: "Ø¬Ø±Ø§Ø­Ø© Ù†Ø¸Ø±ÙŠ",
  number: 2,
  title: "Git (General Review and Surgical Approaches)",
  teacher: "Ø¯. Ø¥Ø³Ø±Ø§Ø¡ + Ø¯. Ø±ÙŠÙ…",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/SU3K1L2.pdf"
},
{
  id: "s103",
  subject: "Ø¬Ø±Ø§Ø­Ø© Ù†Ø¸Ø±ÙŠ",
  number: 3,
  title: "Liver",
  teacher: "Ø¯. Ø¥Ø³Ø±Ø§Ø¡ + Ø¯. Ø±ÙŠÙ…",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/SU3K1L3.pdf"
},
{
  id: "s104",
  subject: "Ø¬Ø±Ø§Ø­Ø© Ù†Ø¸Ø±ÙŠ",
  number: 4,
  title: "Spleen",
  teacher: "Ø¯. Ø¥Ø³Ø±Ø§Ø¡ + Ø¯. Ø±ÙŠÙ…",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/SU3K1L4.pdf"
},
{
  id: "s105",
  subject: "Ø¬Ø±Ø§Ø­Ø© Ù†Ø¸Ø±ÙŠ",
  number: 5,
  title: "Esophageal Diseases & Surgery",
  teacher: "Ø¯. Ø¥Ø³Ø±Ø§Ø¡ + Ø¯. Ø±ÙŠÙ…",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/SU3K1L5.pdf"
},
{
  id: "s106",
  subject: "Ø¬Ø±Ø§Ø­Ø© Ù†Ø¸Ø±ÙŠ",
  number: 6,
  title: "Pancreas",
  teacher: "Ø¯. Ø¥Ø³Ø±Ø§Ø¡ + Ø¯. Ø±ÙŠÙ…",
  dept: "anesthesia",
  stage: "Stage 3.1",
  file: "files/SU3.K1.L6"
},
{
    id: "n201",
    subject: "Ø¹Ù†Ø§ÙŠØ© Ù†Ø¸Ø±ÙŠ",
    number: 1,
    title: "Intensive care unit (ICU)",
    teacher: "Ø¯. Ù…Ø­Ù…Ø¯",
    dept: "anesthesia",
    stage: "Stage 3.1",
    file: "files/ic3k1l1.pdf"
  },
  {
    id: "n202",
    subject: "Ø¹Ù†Ø§ÙŠØ© Ù†Ø¸Ø±ÙŠ",
    number: 2,
    title: "POST ANESTHESIA CARE UNIT (PACU)",
    teacher: "Ø¯. Ù…Ø­Ù…Ø¯",
    dept: "anesthesia",
    stage: "Stage 3.1",
    file: "files/ic3k1l4.pdf"
  },
  {
    id: "n203",
    subject: "Ø¹Ù†Ø§ÙŠØ© Ù†Ø¸Ø±ÙŠ",
    number: 3,
    title: "Standard in PACU",
    teacher: "Ø¯. Ù…Ø­Ù…Ø¯",
    dept: "anesthesia",
    stage: "Stage 3.1",
    file: "files/ic3k1l3.pdf"
  },
  {
    id: "n204",
    subject: "Ø¹Ù†Ø§ÙŠØ© Ù†Ø¸Ø±ÙŠ",
    number: 4,
    title: "ROUTINE OBSERVATION In the PACU",
    teacher: "Ø¯. Ù…Ø­Ù…Ø¯",
    dept: "anesthesia",
    stage: "Stage 3.1",
    file: "files/ic3k1l4.pdf"
  },
  {
    id: "n205",
    subject: "Ø¹Ù†Ø§ÙŠØ© Ù†Ø¸Ø±ÙŠ",
    number: 5,
    title: "Cardiovascular assessment",
    teacher: "Ø¯. Ù…Ø­Ù…Ø¯",
    dept: "anesthesia",
    stage: "Stage 3.1",
    file: "files/ic3k1l5.pdf"
  },
  {
    id: "n206",
    subject: "Ø¹Ù†Ø§ÙŠØ© Ù†Ø¸Ø±ÙŠ",
    number: 6,
    title: "Direct arterial blood pressure",
    teacher: "Ø¯. Ù…Ø­Ù…Ø¯",
    dept: "anesthesia",
    stage: "Stage 3.1",
    file: "files/ic3k1l6.pdf"
  }


  ],

  // ğŸš© Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª (exams)
exams: [
  {
    id: "e16",
    date: "2025-11-25",
    time: "13:00",
    day: "Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡",
    name: "Ø§Ù…ØªØ­Ø§Ù† ØªØ®Ø¯ÙŠØ± Ù†Ø¸Ø±ÙŠ",
    dept: "anesthesia",
    notes: ["n101"],
    courses: ["Ø§Ù„ÙƒÙˆØ±Ø³ Ø§Ù„Ø£ÙˆÙ„"],
    remarks: "Ù‚Ø§Ø¹Ø© 6",
    examType: " ÙˆÙ‡Ù…ÙŠ Ù…Ø¯ Ø«Ø§Ù†ÙŠ"
  }
]

};



/* ---------- Ù…Ø®ØªØµØ± DOM ---------- */
const $ = (s, r=document) => r.querySelector(s);
const $$ = (s, r=document) => Array.from(r.querySelectorAll(s));
const qsParam = (k) => new URLSearchParams(location.search).get(k);

/* ---------- Ø§Ù„Ø£Ø¯ÙˆØ§Øª ---------- */
function escapeHtml(s){ return String(s || '').replace(/[&<>"']/g,(m)=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' })[m]); }
function debounce(fn, ms=250){ let t; return (...a)=>{ clearTimeout(t); t = setTimeout(()=>fn(...a), ms); }; }

/* ---------- Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¨Ø­Ø« Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ (Autocomplete) ---------- */
function initAutocomplete(inputEl, onSelect){
  // container Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª
  const wrapper = document.createElement('div');
  wrapper.className = 'autocomplete';
  inputEl.parentNode.insertBefore(wrapper, inputEl);
  wrapper.appendChild(inputEl);

  const list = document.createElement('div');
  list.className = 'autocomplete-list';
  list.style.display = 'none';
  wrapper.appendChild(list);

  // ØµÙ†Ø¹ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ù…Ù† Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† (Ø¯ÙˆØ±Ø§ØªØŒ Ù…Ù„Ø§Ø²Ù…ØŒ Ù…Ù†Ø´ÙˆØ±Ø§Øª)
  const items = [
    ...DB.courses.map(c => ({
        type: 'course',
        id: c.id,
        title: c.title,
        meta: `${c.subject} - ${c.stage}` // âœ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ù‡Ù†Ø§
    })),
    ...DB.notes.map(n => ({
    type: 'note',
    id: n.id,
    title: `Ù…Ø°ÙƒØ±Ø© ${n.number}: ${n.title}:Ø§Ù„ÙƒÙˆØ±Ø³ ${n.course}`, // âœ… ØªØ±Ù‚ÙŠÙ… Ø§Ù„Ù…Ø°ÙƒØ±Ø© Ø¨Ø§Ù„Ù€ number
    meta: `${n.subject} - ${n.stage} - Ø§Ù„ÙƒÙˆØ±Ø³ ${n.course}` // âœ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒÙˆØ±Ø³ Ù‡Ù†Ø§
})),

    ...DB.culture.map(p => ({
        type: 'post',
        id: p.id,
        title: p.title,
        meta: p.type
    }))
];

  let activeIndex = -1;
  function renderList(filtered){
    list.innerHTML = filtered.map(it=>`<div class="autocomplete-item" data-type="${it.type}" data-id="${it.id}"><span>${escapeHtml(it.title)}</span><small class="muted">${escapeHtml(it.meta)}</small></div>`).join('');
    list.style.display = filtered.length ? 'block' : 'none';
    activeIndex = -1;
  }

  function query(q){
    if(!q) return renderList([]);
    const low = q.toLowerCase();
    const filtered = items.filter(it => (it.title + ' ' + it.meta).toLowerCase().includes(low)).slice(0,8);
    renderList(filtered);
  }

  const run = debounce((ev)=> query(ev.target.value), 160);
  inputEl.addEventListener('input', run);

  // keyboard navigation
  inputEl.addEventListener('keydown', (e)=>{
    if(list.style.display === 'none') return;
    const nodes = Array.from(list.children);
    if(e.key === 'ArrowDown'){ activeIndex = Math.min(activeIndex+1, nodes.length-1); e.preventDefault(); }
    else if(e.key === 'ArrowUp'){ activeIndex = Math.max(activeIndex-1, 0); e.preventDefault(); }
    else if(e.key === 'Enter'){ e.preventDefault(); if(activeIndex>=0) nodes[activeIndex].click(); else { inputEl.form && inputEl.form.requestSubmit(); } }
    nodes.forEach((n,i)=> n.classList.toggle('active', i===activeIndex));
    if(activeIndex>=0) nodes[activeIndex].scrollIntoView({block:'nearest', inline:'nearest'});
  });

  // click on item
  list.addEventListener('click', (e)=>{
    const item = e.target.closest('.autocomplete-item'); if(!item) return;
    const type = item.dataset.type; const id = item.dataset.id;
    list.style.display = 'none';
    inputEl.value = item.querySelector('span').textContent;
    if(typeof onSelect === 'function') onSelect({type, id});
  });

  // click outside -> hide
  document.addEventListener('click', (e)=>{ if(!wrapper.contains(e.target)) list.style.display = 'none'; });
}

/* ---------- ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø¹Ø§Ù…Ø© ---------- */
document.addEventListener('DOMContentLoaded', ()=>{
  const el = $('#year'); if(el) el.textContent = new Date().getFullYear();

  // init autocomplete on any search inputs that exist in header/hero
  const homeInput = $('#homeSearch');
  if(homeInput) initAutocomplete(homeInput, ({type,id})=>{
    if(type === 'course') location.href = `course-details.html?courseId=${id}`;
    else if(type === 'note') location.href = `notes.html?filter=${id}`;
    else if(type === 'post') location.href = `culture-post.html?postId=${id}`;
  });

  // generic: if a search field exists on courses page, enhance it too
  const coursesSearch = $('#courseSearch');
  if(coursesSearch) initAutocomplete(coursesSearch, ({type,id})=>{
    if(type==='course') location.href = `course-details.html?courseId=${id}`;
    else if(type==='post') location.href = `culture-post.html?postId=${id}`;
  });
});

/* ---------- Renderers (per page) ---------- */

/* Helpers Ù„Ø¨Ø·Ø§Ù‚Ø§Øª */
function formatCourseCard(course){
  return `
    <article class="card">
      <img class="thumb" src="${course.thumb}" alt="${escapeHtml(course.title)}" />
      <div class="content">
        <div class="chips"><span class="chip">${escapeHtml(course.subject)}</span><span class="chip">${escapeHtml(course.stage)}</span></div>
        <h3>${escapeHtml(course.title)}</h3>
        <p class="muted">${escapeHtml(course.desc)}</p>
        <div style="margin-top:10px;display:flex;gap:8px;justify-content:flex-start">
          <a class="btn" href="course-details.html?courseId=${course.id}">ØªÙØ§ØµÙŠÙ„</a>
          <a class="btn ghost" href="notes.html?course=${course.id}">Ù…Ù„Ø§Ø²Ù… Ù…ØªØ¹Ù„Ù‚Ø©</a>
        </div>
      </div>
    </article>
  `;
}
function formatNoteCard(note){
  return `
    <article class="card">
      <div class="content">
        <div class="chips">
          <span class="chip">${escapeHtml(note.subject)}</span>
          <span class="chip">${escapeHtml(note.stage)}</span> <!-- âœ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ù‡Ù†Ø§ -->
          <span class="chip">Ù…Ø°ÙƒØ±Ø© ${note.number}</span>
        </div>
        <h3>${escapeHtml(note.title)}</h3>
        <p class="muted">Ø§Ù„Ù…Ø¯Ø±Ù‘Ø³: ${escapeHtml(note.teacher)}</p>
        <div style="margin-top:10px;display:flex;gap:8px">
          <a class="btn" href="${note.file}" download>ØªØ­Ù…ÙŠÙ„</a>
        </div>
      </div>
    </article>
  `;
}

function formatCultureCard(post){
  return `
    <article class="card">
      <img class="thumb" src="${post.image}" alt="${escapeHtml(post.title)}" />
      <div class="content">
        <h3>${escapeHtml(post.title)}</h3>
        <p class="muted">${escapeHtml(post.excerpt)}</p>
        <div style="margin-top:10px;display:flex;gap:8px">
          <a class="btn" href="culture-post.html?postId=${post.id}">Ø§Ù‚Ø±Ø£</a>
        </div>
      </div>
    </article>
  `;
}

/* Page: Home */
function renderHome(){
  const hc = $('#homeCourses'); if(hc) hc.innerHTML = DB.courses.slice(0,3).map(formatCourseCard).join('');
  const hn = $('#homeNotes'); if(hn) hn.innerHTML = DB.notes.slice(0,3).map(formatNoteCard).join('');
  const hcu = $('#homeCulture'); if(hcu) hcu.innerHTML = DB.culture.slice(0,3).map(formatCultureCard).join('');
  const hf = $('#homeSearchForm');
  if(hf) hf.addEventListener('submit', e=>{
    e.preventDefault();
    const q = $('#homeSearch').value.trim();
    if(!q) return location.href='courses.html';
    location.href = `courses.html?search=${encodeURIComponent(q)}`;
  });
}

/* Page: Departments */
function renderDepartments(){
  const root = $('#deptList');
  if(!root) return;
  root.innerHTML = DB.departments.map(d=>`
    <article class="card">
      <div class="content">
        <h3>${escapeHtml(d.name)}</h3>
        <p class="muted">${escapeHtml(d.about)}</p>
        <div style="margin-top:10px">
          <button class="btn" data-dept="${d.id}">Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø³Ù…</button>
        </div>
      </div>
    </article>
  `).join('');

  document.body.addEventListener('click', (e)=>{
    const deptId = e.target.getAttribute('data-dept');
    if(deptId) showDeptDetails(deptId);
  });
}
function showDeptDetails(deptId){
  const d = DB.departments.find(x=>x.id===deptId); if(!d) return;
  $('#deptTitle').textContent = d.name;
  $('#deptStages').innerHTML = d.stages.map(s=>`<button class="chip" data-stage="${encodeURIComponent(s)}">${escapeHtml(s)}</button>`).join(' ');
  $('#deptTeachers').innerHTML = d.teachers.map(t=>`<span class="chip">${escapeHtml(t)}</span>`).join(' ');
  $('#deptDetails').hidden = false;
  $('#stageContent').innerHTML = d.stages.map(stage=>{
    const courses = DB.courses.filter(c=>c.dept===deptId && c.stage===stage);
    const notes = DB.notes.filter(n=>n.dept===deptId && n.stage===stage);
    return `<div class="card"><div class="content"><h4>${escapeHtml(stage)}</h4>
      <div><strong>Ø¯ÙˆØ±Ø§Øª:</strong> ${courses.map(c=>escapeHtml(c.title)).join(', ') || 'Ù„Ø§ ØªÙˆØ¬Ø¯'}</div>
      <div><strong>Ù…Ù„Ø§Ø²Ù…:</strong> ${notes.map(n=>escapeHtml(n.title)).join(', ') || 'Ù„Ø§ ØªÙˆØ¬Ø¯'}</div></div></div>`;
  }).join('');
}

/* Page: Courses */
function renderCourses(){
  const deptSel = $('#filterDepartment');
  if(!deptSel) return;
  deptSel.innerHTML = '<option value=\"\">ÙƒÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</option>';
  DB.departments.forEach(d=> deptSel.insertAdjacentHTML('beforeend', `<option value="${d.id}">${escapeHtml(d.name)}</option>`));
  const uniqueStages = [...new Set(DB.courses.map(c=>c.stage))];
  const stageSel = $('#filterStage');
  stageSel.innerHTML = '<option value="">ÙƒÙ„ Ø§Ù„Ù…Ø±Ø§Ø­Ù„</option>';
  uniqueStages.forEach(s=> stageSel.insertAdjacentHTML('beforeend', `<option value="${s}">${escapeHtml(s)}</option>`));

  const grid = $('#coursesGrid');
  const initQuery = qsParam('search') || '';

  $('#courseSearch').value = initQuery;

  function applyFilters(){
    const q = ($('#courseSearch').value || '').trim().toLowerCase();
    const dept = $('#filterDepartment').value;
    const stage = $('#filterStage').value;
    let list = DB.courses.slice();
    if(q) list = list.filter(c => (c.title + ' ' + c.desc + ' ' + c.subject).toLowerCase().includes(q));
    if(dept) list = list.filter(c=>c.dept===dept);
    if(stage) list = list.filter(c=>c.stage===stage);
    grid.innerHTML = list.map(formatCourseCard).join('') || '<div class="card"><div class="content">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</div></div>';
  }

  $('#courseSearch').addEventListener('input', debounce(applyFilters, 160));
  $('#filterDepartment').addEventListener('change', applyFilters);
  $('#filterStage').addEventListener('change', applyFilters);
  applyFilters();
}

/* Page: Course Details */
function renderCourseDetails(){
  const courseId = qsParam('courseId');
  if(!courseId) return $('#courseTitle').textContent = 'Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø¯ÙˆØ±Ø©';
  const course = DB.courses.find(c=>c.id===courseId);
  if(!course) return $('#courseTitle').textContent = 'Ø§Ù„Ø¯ÙˆØ±Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©';
  $('#courseTitle').textContent = course.title;
  $('#courseThumb').src = course.thumb;
  $('#courseMeta').innerHTML = `<span class="chip">${escapeHtml(course.subject)}</span><span class="chip">${escapeHtml(course.stage)}</span><span class="chip">${escapeHtml(course.doctor)}</span><span class="chip">${escapeHtml(course.dept)}</span>`;
  const listEl = $('#lessonList'); listEl.innerHTML = '';
  course.lessons.forEach((l, idx)=>{
    const watchedKey = `watched:${courseId}:${l.id}`;
    const watched = localStorage.getItem(watchedKey) === '1';
    const li = document.createElement('li');
    li.innerHTML = `<span>${idx+1}. ${escapeHtml(l.title)}</span>
                    <div style="display:flex;gap:8px">
                      <button class="btn" data-play="${l.id}">Ø´ØºÙ‘Ù„</button>
                      <button class="btn ghost" data-toggle-watched="${l.id}">${watched ? 'Ù…ÙØ´Ø§Ù‡ÙØ¯' : 'Ø¹Ù„Ù‘Ù… ÙƒÙ…Ø´Ø§Ù‡Ø¯Ø©'}</button>
                    </div>`;
    listEl.appendChild(li);
  });

  function updateProgress(){
    const total = course.lessons.length;
    const watchedCount = course.lessons.reduce((s,l)=> s + (localStorage.getItem(`watched:${courseId}:${l.id}`)==='1' ? 1:0), 0);
    const percent = Math.round((watchedCount/total)*100);
    $('#courseProgress').style.width = percent+'%';
  }
  updateProgress();

  const player = $('#ytPlayer'); const nowPlaying = $('#nowPlaying');
  function playLesson(lessonId){
    const lesson = course.lessons.find(x=>x.id===lessonId); if(!lesson) return;
    player.src = `https://www.youtube.com/embed/${lesson.yt}?rel=0&autoplay=1`;
    nowPlaying.textContent = lesson.title;
    localStorage.setItem(`watched:${courseId}:${lessonId}`,'1');
    $$('[data-toggle-watched]').forEach(b=>{
      const id = b.getAttribute('data-toggle-watched');
      const watched = localStorage.getItem(`watched:${courseId}:${id}`) === '1';
      b.textContent = watched ? 'Ù…ÙØ´Ø§Ù‡ÙØ¯' : 'Ø¹Ù„Ù‘Ù… ÙƒÙ…Ø´Ø§Ù‡Ø¯Ø©';
    });
    updateProgress();
  }

  document.body.addEventListener('click', (e)=>{
    const playId = e.target.getAttribute('data-play'); if(playId) playLesson(playId);
    const toggleId = e.target.getAttribute('data-toggle-watched');
    if(toggleId){
      const key = `watched:${courseId}:${toggleId}`;
      const cur = localStorage.getItem(key) === '1';
      localStorage.setItem(key, cur ? '0':'1');
      updateProgress();
      e.target.textContent = localStorage.getItem(key) === '1' ? 'Ù…ÙØ´Ø§Ù‡ÙØ¯' : 'Ø¹Ù„Ù‘Ù… ÙƒÙ…Ø´Ø§Ù‡Ø¯Ø©';
    }
  });

  $('#prevLesson').addEventListener('click', ()=>{
    const current = course.lessons.findIndex(l => $('#nowPlaying').textContent === l.title);
    const prev = Math.max(0, current-1);
    if(current === -1) playLesson(course.lessons[0].id); else playLesson(course.lessons[prev].id);
  });
  $('#nextLesson').addEventListener('click', ()=>{
    const current = course.lessons.findIndex(l => $('#nowPlaying').textContent === l.title);
    const next = Math.min(course.lessons.length-1, current+1);
    if(current === -1) playLesson(course.lessons[0].id); else playLesson(course.lessons[next].id);
  });
}

/* Page: Notes */
function renderNotes(){
  const deptSel = $('#noteDept'), stageSel = $('#noteStage'), subjSel = $('#noteSubject');
  if(!deptSel) return;
  deptSel.innerHTML = '<option value="">ÙƒÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</option>'; DB.departments.forEach(d=> deptSel.insertAdjacentHTML('beforeend', `<option value="${d.id}">${escapeHtml(d.name)}</option>`));
  stageSel.innerHTML = '<option value="">ÙƒÙ„ Ø§Ù„Ù…Ø±Ø§Ø­Ù„</option>'; [...new Set(DB.notes.map(n=>n.stage))].forEach(s=> stageSel.insertAdjacentHTML('beforeend', `<option value="${s}">${escapeHtml(s)}</option>`));
  subjSel.innerHTML = '<option value="">ÙƒÙ„ Ø§Ù„Ù…ÙˆØ§Ø¯</option>'; [...new Set(DB.notes.map(n=>n.subject))].forEach(s=> subjSel.insertAdjacentHTML('beforeend', `<option value="${s}">${escapeHtml(s)}</option>`));
  const grid = $('#notesGrid');

  function apply(){
    const q = ($('#noteSearch').value||'').trim().toLowerCase();
    const dept = deptSel.value; const stage = stageSel.value; const subject = subjSel.value;
    let list = DB.notes.slice();
    if(q) list = list.filter(n => (n.title + ' ' + n.teacher + ' ' + n.subject).toLowerCase().includes(q));
    if(dept) list = list.filter(n=> n.dept===dept);
    if(stage) list = list.filter(n=> n.stage===stage);
    if(subject) list = list.filter(n=> n.subject===subject);
    grid.innerHTML = list.map(formatNoteCard).join('') || '<div class="card"><div class="content">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª</div></div>';
  }
  $('#noteSearch').addEventListener('input', debounce(apply, 160));
  deptSel.addEventListener('change',apply); stageSel.addEventListener('change',apply); subjSel.addEventListener('change',apply);

  const qcourse = qsParam('course');
  if(qcourse){
    const c = DB.courses.find(x=>x.id===qcourse);
    if(c) $('#noteSearch').value = c.subject;
  }
  apply();
}

/* Page: Exams */
function renderExams(){
  const deptSel = $('#examDeptFilter');
  if(!deptSel) return;
  deptSel.innerHTML = '<option value="">ÙƒÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</option>';
  DB.departments.forEach(d=> deptSel.insertAdjacentHTML('beforeend', `<option value="${d.id}">${escapeHtml(d.name)}</option>`));
  const tbody = $('#examTable tbody');
  function apply(){
    const dept = deptSel.value;
    let list = DB.exams.slice();
    if(dept) list = list.filter(e=> e.dept === dept);
    tbody.innerHTML = list.map(e=>{
      const notesLinks = e.notes.map(id=>{ const n=DB.notes.find(x=>x.id===id); return n? `<a href="${n.file}" download>${escapeHtml(n.title)}</a>` : '' }).join(', ');
      const coursesLinks = e.courses.map(id=>{ const c=DB.courses.find(x=>x.id===id); return c? `<a href="course-details.html?courseId=${c.id}">${escapeHtml(c.title)}</a>` : '' }).join(', ');
      return `<tr>
  <td data-label="Ø§Ù„ØªØ§Ø±ÙŠØ®">${escapeHtml(e.date)}</td>
  <td data-label="Ø§Ù„ÙˆÙ‚Øª">${escapeHtml(e.time)}</td>
  <td data-label="Ø§Ù„ÙŠÙˆÙ…">${escapeHtml(e.day)}</td>
    <td data-label="Ù†ÙˆØ¹ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†">${escapeHtml(e.examType)}</td>
  <td data-label="Ù†ÙˆØ¹ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†">${escapeHtml(e.session)}</td>
  <td data-label="Ø§Ø³Ù… Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†">${escapeHtml(e.name)}</td>
  <td data-label="Ø§Ù„Ù‚Ø³Ù…">${escapeHtml(e.dept)}</td>
  <td data-label="Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª / Ø§Ù„Ø¯ÙˆØ±Ø§Øª">${notesLinks} ${coursesLinks}</td>
  <td data-label="Ø±Ù‚Ù… Ø§Ù„Ù‚Ø§Ø¹Ø©">${escapeHtml(e.remarks)}</td>
</tr>`;

    }).join('') || '<tr><td colspan="6">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ø¹ÙŠØ¯</td></tr>';
  }
  deptSel.addEventListener('change',apply); apply();
}
/* ---------- ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ù†Ø¯Ø± Ø­Ø³Ø¨ Ø§Ù„ØµÙØ­Ø© ---------- */
document.addEventListener('DOMContentLoaded', ()=>{
  const page = document.body.getAttribute('data-page');
  if(page === 'home') renderHome();
  else if(page === 'departments') renderDepartments();
  else if(page === 'courses') renderCourses();
  else if(page === 'course-details') renderCourseDetails();
  else if(page === 'notes') renderNotes();
  else if(page === 'exams') renderExams();
});
const cultureModal = document.getElementById("cultureModal");
const closeCultureModal = document.getElementById("closeCultureModal");
const cultureModalOverlay = document.getElementById("cultureModalOverlay");

// ÙØªØ­ Ø§Ù„Ù€ modal Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠ Ø¹Ù†ØµØ± (Ù…Ø«Ø§Ù„ØŒ Ù„Ø§Ø­Ù‚Ù‹Ø§ Ø§Ø±Ø¨Ø·Ù‡ Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ)
function openCultureModal(title, body, img) {
  document.getElementById("cultureModalTitle").textContent = title;
  document.getElementById("cultureModalBody").textContent = body;
  document.getElementById("cultureImage").src = img;

  cultureModal.classList.add("show");
}


function closePopup() {
  document.getElementById("welcomePopup").style.display = "none";
}

// Ø¥ØºÙ„Ø§Ù‚ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø®Ø§Ø±Ø¬ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚
window.onclick = function(event) {
  const popup = document.getElementById("welcomePopup");
  if (event.target === popup) closePopup();
}
// Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù€ modal Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ Ø£Ùˆ Ø§Ù„Ø®Ù„ÙÙŠØ©
closeCultureModal.addEventListener("click", () => {
  cultureModal.classList.remove("show");
});

cultureModalOverlay.addEventListener("click", () => {
  cultureModal.classList.remove("show");
});
function goToPost(postId) {
  const post = DB.culture.find(p => p.id === postId);
  if (!post) return;

  document.getElementById("post-container").innerHTML = `
    <h1>${escapeHtml(post.title)}</h1>
    <img src="${post.image}" alt="${escapeHtml(post.title)}">
    ${renderBody(post.body)}
  `;
}
function renderBody(body) {
  return body.map(item => {
    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù†Øµ Ø¹Ø¨Ø§Ø±Ø© Ø¹Ù† Ø±Ø§Ø¨Ø·
    if (typeof item === "object" && item.type === "link") {
      // Ø±Ø§Ø¨Ø· ÙŠÙ†ÙØ° Ø¯Ø§Ù„Ø© JS ØªØ¹Ø±Ø¶ Ø§Ù„Ù…Ù†Ø´ÙˆØ± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
      return `<p><a href="#" onclick="showPost('${item.to}'); return false;">${escapeHtml(item.text)}</a></p>`;
    } 
    // Ù†Øµ Ø¹Ø§Ø¯ÙŠ
    else if (typeof item === "string") {
      return `<p>${escapeHtml(item)}</p>`;
    }
  }).join('');
}

// Ø¯Ø§Ù„Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†Ø´ÙˆØ± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
function showPost(postId) {
  const post = DB.culture.find(p => p.id === postId);
  if (!post) return;
  // Ø§ÙØªØ±Ø¶ Ø£Ù† Ù„Ø¯ÙŠÙƒ Ø¹Ù†ØµØ± ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†Ø´ÙˆØ±ØŒ Ù…Ø«Ù„: <div id="post-container"></div>
  const container = document.getElementById("post-container");
  if (!container) return;

  container.innerHTML = `
    <h1>${escapeHtml(post.title)}</h1>
    <img src="${post.image}" alt="${escapeHtml(post.title)}">
    ${renderBody(post.body)}
  `;
}
const modal = document.querySelector('.modal');
const closeBtn = document.querySelector('.modal-close');

closeBtn.addEventListener('click', () => {
  modal.classList.remove('show'); // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
});
document.querySelectorAll('.modal-close').forEach(btn => {
  btn.addEventListener('click', () => {
    const modal = btn.closest('.modal');
    modal.classList.remove('show');
  });
window.addEventListener('resize', apply);
let notesLinks = e.notes.map(id=>{
  const n=DB.notes.find(x=>x.id===id);
  if(!n) return '';
  return window.innerWidth < 768 
         ? `<a href="${n.file}" download>${escapeHtml(n.title).slice(0,10)}...</a>` 
         : `<a href="${n.file}" download>${escapeHtml(n.title)}</a>`;
}).join(', ');

});

